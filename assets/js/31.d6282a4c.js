(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{429:function(n,t,e){"use strict";e.r(t);var s=e(42),r=Object(s.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h3",{attrs:{id:"捕捉错误方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#捕捉错误方式"}},[n._v("#")]),n._v(" 捕捉错误方式")]),n._v(" "),e("ol",[e("li",[n._v("try...catch")]),n._v(" "),e("li",[n._v("window.onerror")]),n._v(" "),e("li",[n._v("throw 'error message'")])]),n._v(" "),e("h4",{attrs:{id:"常见的错误类型："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见的错误类型："}},[n._v("#")]),n._v(" 常见的错误类型：")]),n._v(" "),e("p",[n._v("类型转换错误：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('function concat(str1, str2, str3){ \n var result = str1 + str2; \n if (str3){ //绝对不要这样!!! \n result += str3; \n } \n return result; \n}\n//正确的姿态\nfunction concat(str1, str2, str3){ \n var result = str1 + str2; \n if (typeof str3 == "string"){ //恰当的比较\n result += str3; \n } \n return result; \n}\n')])])]),e("p",[n._v("数据类型错误")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('//不安全的函数，任何非字符串值都会导致错误\nfunction getQueryString(url){ \n var pos = url.indexOf("?"); \n if (pos > -1){ \n return url.substring(pos +1); \n } \n return ""; \n}\n\nfunction getQueryString(url){ \n if (typeof url == "string"){ //通过检查类型确保安全\n var pos = url.indexOf("?"); \n if (pos > -1){ \n return url.substring(pos +1); \n } \n } \n return ""; \n}\n')])])]),e("p",[n._v("通信错误：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("一般都是没有对url里面的参数进行编码所致\n编码：encodeURIComponent(name)\n解码：decodeURIComponent(val)\n\n")])])]),e("h4",{attrs:{id:"把错误记录到服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#把错误记录到服务器"}},[n._v("#")]),n._v(" 把错误记录到服务器")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('实现思路：\n1. 需要在服务器上创建一个页面（或者一个服务器入口点）。页面作用是冲查询字符串中取得数据，然后再将数据写入错误日志中。\n2. 利用img的src属性实现：\nfunction logError(sev, msg){ \n var img = new Image(); \n img.src = "log.php?sev=" + encodeURIComponent(sev) + "&msg=" + \n encodeURIComponent(msg); \n}\n优点：没有跨域限制。所有的浏览器都支持image对象。\n结合try...catch..\nfor (var i=0, len=mods.length; i < len; i++){ \n try { \n mods[i].init(); \n } catch (ex){ \n logError("nonfatal", "Module init failed: " + ex.message); \n } \n}\n根据错误的严重程度，可以区分致命错误和非致命错误。再做对应的处理。\n\n\n')])])]),e("h4",{attrs:{id:"把错误写入当前页面："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#把错误写入当前页面："}},[n._v("#")]),n._v(" 把错误写入当前页面：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('function log(message){ \n var console = document.getElementById("debuginfo"); \n if (console === null){ \n console = document.createElement("div"); \n console.id = "debuginfo"; \n console.style.background = "#dedede"; \n console.style.border = "1px solid silver"; \n console.style.padding = "5px"; \n console.style.width = "400px"; \n console.style.position = "absolute"; \n console.style.right = "0px"; \n console.style.top = "0px"; \n document.body.appendChild(console); \n } \n console.innerHTML += "<p>" + message + "</p>"; \n}\n')])])]),e("h4",{attrs:{id:"抛出错误："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#抛出错误："}},[n._v("#")]),n._v(" 抛出错误：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('throw new Error("divide(): Both arguments must be numbers.");`\n\n')])])])])}),[],!1,null,null,null);t.default=r.exports}}]);